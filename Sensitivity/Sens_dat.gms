table legnodes (sen,ssen)

              60            40            20            10
1             0.999210123   0.99823771    0.993128599   0.973906529
2             0.995840525   0.990726239   0.963971927   0.865063367
3             0.989787895   0.97725995    0.912234428   0.679409568
4             0.981067202   0.957916819   0.839116972   0.433395394
5             0.969701789   0.932812808   0.746331906   0.148874339
6             0.955722256   0.902098807   0.636053681   -0.148874339
7             0.939166276   0.865959503   0.510867002   -0.433395394
8             0.920078476   0.824612231   0.373706089   -0.679409568
9             0.898510311   0.778305651   0.227785851   -0.865063367
10            0.874519923   0.727318255   0.076526521   -0.973906529
11            0.848171985   0.671956685   -0.076526521  
12            0.819537526   0.61255389    -0.227785851  
13            0.78869374    0.549467125   -0.373706089  
14            0.755723775   0.483075802   -0.510867002  
15            0.720716513   0.413779204   -0.636053681  
16            0.683766327   0.341994091   -0.746331906  
17            0.644972828   0.268152185   -0.839116972  
18            0.604440597   0.192697581   -0.912234428  
19            0.562278901   0.116084071   -0.963971927  
20            0.5186014     0.038772418   -0.993128599  
21            0.473525842   -0.038772418                
22            0.427173742   -0.116084071                
23            0.379670057   -0.192697581                
24            0.331142848   -0.268152185                
25            0.281722937   -0.341994091                
26            0.231543551   -0.413779204                
27            0.180739965   -0.483075802                
28            0.129449135   -0.549467125                
29            0.077809334   -0.61255389                 
30            0.025959772   -0.671956685                
31            -0.025959772  -0.727318255                
32            -0.077809334  -0.778305651                
33            -0.129449135  -0.824612231                
34            -0.180739965  -0.865959503                
35            -0.231543551  -0.902098807                
36            -0.281722937  -0.932812808                
37            -0.331142848  -0.957916819                
38            -0.379670057  -0.97725995                 
39            -0.427173742  -0.990726239                
40            -0.473525842  -0.99823771                 
41            -0.5186014                                
42            -0.562278901                              
43            -0.604440597                              
44            -0.644972828                              
45            -0.683766327                              
46            -0.720716513                              
47            -0.755723775                              
48            -0.78869374                               
49            -0.819537526                              
50            -0.848171985                              
51            -0.874519923                              
52            -0.898510311                              
53            -0.920078476                              
54            -0.939166276                              
55            -0.955722256                              
56            -0.969701789                              
57            -0.981067202                              
58            -0.989787895                              
59            -0.995840525                              
60            -0.999210123                              
;

*grid(i) = (b − a) ∗ (zerosval(′maxdegree′, i) + 1)/2 + a
parameter
grida /.5/ 
gridb /4/
;

parameter leggrid(sen) ;
leggrid(sen) = (gridb/2-grida)*(legnodes(sen,'10')+1)/2 + grida ;
legnodes(sen,ssen) = (gridb-grida)*(legnodes(sen,ssen)+1)/2 + grida ;
display legnodes ;


table hernodes (sen,ssen)

              60            40            20            10            5
1             10.15910925   8.098761139   5.38748089    3.436159119   2.020183
2             9.520903677   7.411582531   4.60368245    2.532731674   0.9585725
3             8.992398001   6.840237305   3.94476404    1.756683649   4.440892e-16
4             8.520569284   6.328255351   3.347854567   1.03661083    -0.9585725	
5             8.085188654   5.854095056   2.788806058   0.342901327   -2.020183
6             7.675839938   5.406654248   2.254974002   -0.342901327
7             7.286276594   4.979260979   1.738537712   -1.03661083
8             6.912381532   4.567502073   1.234076215   -1.756683649
9             6.551259167   4.168257067   0.737473729   -2.532731674
10            6.200773558   3.779206753   0.245340708   -3.436159119
11            5.859290196   3.398558266   -0.245340708  
12            5.525521086   3.024879884   -0.737473729  
13            5.198426535   2.656995998   -1.234076215  
14            4.877150077   2.293917142   -1.738537712  
15            4.560973758   1.934791472   -2.254974002  
16            4.249286436   1.578869895   -2.788806058  
17            3.941560734   1.225480109   -3.347854567  
18            3.637335876   0.874006612   -3.94476404   
19            3.336204654   0.523874714   -4.60368245   
20            3.037803338   0.174537215   -5.38748089   
21            2.741803748   -0.174537215                
22            2.447906902   -0.523874714                
23            2.155837871   -0.874006612                
24            1.865341531   -1.225480109                
25            1.576179012   -1.578869895                
26            1.288124675   -1.934791472                
27            1.0009635     -2.293917142                
28            0.714488782   -2.656995998                
29            0.428500064   -3.024879884                
30            0.142801239   -3.398558266                
31            -0.142801239  -3.779206753                
32            -0.428500064  -4.168257067                
33            -0.714488782  -4.567502073                
34            -1.0009635    -4.979260979                
35            -1.288124675  -5.406654248                
36            -1.576179012  -5.854095056                
37            -1.865341531  -6.328255351                
38            -2.155837871  -6.840237305                
39            -2.447906902  -7.411582531                
40            -2.741803748  -8.098761139                
41            -3.037803338                              
42            -3.336204654                              
43            -3.637335876                              
44            -3.941560734                              
45            -4.249286436                              
46            -4.560973758                              
47            -4.877150077                              
48            -5.198426535                              
49            -5.525521086                              
50            -5.859290196                              
51            -6.200773558                              
52            -6.551259167                              
53            -6.912381532                              
54            -7.286276594                              
55            -7.675839938                              
56            -8.085188654                              
57            -8.520569284                              
58            -8.992398001                              
59            -9.520903677                              
60            -10.15910925                              
;

parameter 
hergrid(sen)
herwgt(sen) /
1	7.64043E-06
2	0.001343646
3	0.033874395
4	0.240138611
5	0.61086634
6	0.61086634
7	0.240138611
8	0.033874395
9	0.001343646
10	7.64043E-06
/ ;

grida = .5 ;
gridb = 4 ;
hergrid(sen) = (gridb/2-grida)*(hernodes(sen,'10')+3.436159119)/(2*3.436159119) + grida ;
*hernodes(sen,'10') = (gridb-grida)*(hernodes(sen,'10')+3.436159119)/(2*3.436159119) + grida ;
display hernodes ;
